<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FriendTree - Graphe Social Discord</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.0/cytoscape.min.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="loader-overlay">
        <div class="loader-content">
            <div class="spinner"></div>
            <p>Chargement des donn√©es...</p>
        </div>
    </div>

    <div id="cy"></div>

    <div id="control-panel" class="draggable-panel">
        <h2 class="panel-header">üõ∞Ô∏è Contr√¥les du Graphe</h2>
        <p id="connexion-status">Statut : Non connect√©.</p>
        
        <hr>
        
        <div id="controls">
            <button id="btn-discord-connect" title="Lance le processus d'autorisation Discord pour collecter les donn√©es de l'utilisateur.">Connecter Discord</button>
            <button id="btn-reload-map" title="Recharge les donn√©es depuis la base de donn√©es persistante et met √† jour le graphe.">Recharger la Carte (DB)</button>
            <button id="btn-toggle-servers" title="Afficher/Masquer les n≈ìuds des serveurs Discord.">Afficher les Serveurs</button>
            <button id="btn-reset" title="R√©initialise la vue locale du graphe (ne supprime pas la DB).">R√©initialiser la Carte Locale</button>
        </div>

        <hr>

        <h3>üîç Localisation et Trajet</h3>
        <label for="search-input">Rechercher N≈ìud (Nom/ID) :</label>
        <input type="text" id="search-input" placeholder="ID Discord ou Nom">
        <button id="btn-search-node">Localiser</button>

        <br>
        
        <label for="trajet-source">Trajet (Source Nom/ID) :</label>
        <input type="text" id="trajet-source" placeholder="Source Nom/ID">
        <label for="trajet-target">Trajet (Cible Nom/ID) :</label>
        <input type="text" id="trajet-target" placeholder="Cible Nom/ID">
        <button id="btn-find-path">Trouver le Trajet Social</button>
        <div id="path-result"></div>

    </div>

    <div id="details-panel" class="draggable-panel" style="display:none;">
        <h2 class="panel-header">üìä D√©tails de l'√âl√©ment</h2>
        <div id="details-content">
            <p>Cliquez sur un n≈ìud pour afficher les d√©tails.</p>
        </div>
    </div>
    
    <div id="controls-panel" class="draggable-panel">
        <h2 class="panel-header">‚öôÔ∏è Outils d'Analyse Avanc√©e</h2>

        <h3>Disposition (Layout)</h3>
        <button id="layout-cose">Cose (R√©seau Social)</button>
        <button id="layout-concentric">Concentric (Regroupement)</button>
        
        <hr>
        <h3>Exporter le Graphe</h3>
        <button id="export-png">T√©l√©charger en PNG</button>
        
        <hr>
        <h3>Filtrage des Liens Faibles</h3>
        <p>Masquer les liens avec moins de serveurs en commun.</p>
        <label for="weight-filter">Min. Serveurs en Commun: <span id="current-weight">1</span></label>
        <input type="range" id="weight-filter" min="1" max="10" value="1">

        <hr>
        <h3>Analyse N≈ìuds/Liens (Centralit√©)</h3>
        <div id="analysis-detail">
            <p>Cliquez sur un n≈ìud (utilisateur) pour ses m√©triques de centralit√© ou sur un lien pour voir le poids.</p>
        </div>
    </div>


    <div id="discord-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Autorisation Discord</h2>
            <p>Vous allez √™tre redirig√© vers Discord pour autoriser l'application √† lire votre liste de serveurs et votre profil. Vos donn√©es seront ensuite sauvegard√©es sur notre base de donn√©es persistante pour cr√©er le graphe social.</p>
            <p>Ceci est un processus s√©curis√© via le protocole OAuth2 de Discord.</p>
            <button id="btn-modal-continue">Continuer vers Discord</button>
        </div>
    </div>

    <script src="app.js"></script>

</body>
</html>
